Issue に対する TDD/DDD/レイヤードアーキテクチャ実装をレビューします。

以下の手順に従ってください：

1. **引数チェック**:
   - `$ARGUMENTS` が提供されているかを確認
   - 提供されていない場合、すぐに終了し、Issue番号を引数として渡すようにユーザーに日本語で促す

2. **実装成果物の収集**:
   - 期待されるすべてのドキュメントとコードを確認:
     - ユースケース仕様: `docs/use_cases/issue-$ARGUMENTS-*.md`
     - ドメインモデル: `docs/domain/issue-$ARGUMENTS-*.md`
     - テスト計画: `docs/test_plan/issue-$ARGUMENTS-*.md`
     - テストレポート: `docs/test_report/issue-$ARGUMENTS-*.md`

3. **ドメイン層レビュー**:
   - `domain/entities/` のエンティティをチェック
   - `domain/value_objects/` の値オブジェクトをレビュー
   - ドメインサービスがDDD原則に従っているかを確認
   - ビジネスルールが適切にカプセル化されているかを確認
   - 集約境界を検証

4. **アプリケーション層レビュー**:
   - `application/use_cases/` のユースケースをチェック
   - DTOが適切に定義されているかを確認
   - ユースケースがオーケストレーションのみで、ビジネスロジックを含まないことを確認
   - 関心の分離が適切かをチェック

5. **インフラストラクチャ層レビュー**:
   - リポジトリ実装を確認
   - データベースモデルとマッパーをチェック
   - インフラストラクチャの詳細がドメインに漏れていないことを確認
   - 外部サービスアダプターをレビュー

6. **プレゼンテーション層レビュー**:
   - APIエンドポイントまたはCLIコマンドをチェック
   - 入力検証を確認
   - エラーハンドリングとレスポンスをレビュー
   - コントローラーにビジネスロジックがないことを確認

7. **テストカバレッジ分析**:
   ```bash
   pytest --cov=domain --cov=application --cov=infrastructure --cov=presentation \
          --cov-report=term-missing
   ```
   - カバレッジが80%以上であることを確認
   - テストされていない重要パスをチェック

8. **コード品質チェック**:
   ```bash
   # リンティング
   ruff check . --statistics
   
   # 型チェック
   pyright --stats
   
   # 複雑性分析
   # 循環的複雑度が10を超える関数をチェック
   ```

9. **アーキテクチャ準拠性チェック**:
   - レイヤー間に循環依存がないことを確認
   - 依存方向をチェック: プレゼンテーション → アプリケーション → ドメイン
   - ドメインに外部依存がないことを確認
   - 依存性注入の適切な使用を検証

10. **Given-When-Then検証**:
    - ユースケース仕様のすべてのシナリオが実装されていることを確認
    - 各シナリオのテストカバレッジをチェック
    - テストがGiven-When-Then構造に従っていることを確認

11. **レビューレポート作成**:
    `docs/review/issue-$ARGUMENTS-review.md` を日本語で作成:

```markdown
# レビューレポート: <機能名>

Issue: #$ARGUMENTS
レビュー日時: <timestamp>

## 実装成果物の確認

### ドキュメント
- [x] ユースケース仕様: docs/use_cases/issue-$ARGUMENTS-*.md
- [x] ドメインモデル設計: docs/domain/issue-$ARGUMENTS-*.md
- [x] テスト計画: docs/test_plan/issue-$ARGUMENTS-*.md
- [x] テストレポート: docs/test_report/issue-$ARGUMENTS-*.md

### 実装レイヤー
- [x] ドメイン層
- [x] アプリケーション層
- [x] インフラストラクチャ層
- [x] プレゼンテーション層

## アーキテクチャ準拠性

### DDD原則
- [ ] ユビキタス言語の一貫性
- [ ] 集約境界の適切性
- [ ] ドメインロジックの純粋性
- [ ] 値オブジェクトの不変性

### レイヤードアーキテクチャ
- [ ] レイヤー間の依存方向
- [ ] 関心の分離
- [ ] 依存性注入の活用

### TDD実践
- [ ] RED-GREEN-REFACTORサイクル
- [ ] テストファースト開発
- [ ] テストカバレッジ: X%

## 品質メトリクス

| メトリクス | 結果 | 基準 | 評価 |
|-----------|------|------|------|
| テストカバレッジ | X% | >80% | ✅/❌ |
| 循環的複雑度（最大） | X | <10 | ✅/❌ |
| Ruffエラー数 | X | 0 | ✅/❌ |
| Pyrightエラー数 | X | 0 | ✅/❌ |

## 改善提案

### 必須対応項目
1. <重要度：高の改善点>
2. <重要度：高の改善点>

### 推奨改善項目
1. <重要度：中の改善点>
2. <重要度：中の改善点>

### 将来的な改善案
1. <重要度：低の改善点>
2. <重要度：低の改善点>

## Given-When-Thenシナリオ実装状況

| シナリオ | 実装 | テスト | カバレッジ |
|---------|------|--------|------------|
| 基本成功ケース | ✅ | ✅ | 100% |
| エッジケース1 | ✅ | ✅ | 100% |
| エラーケース1 | ✅ | ✅ | 100% |

## 総評

<全体的な評価と次のステップの推奨事項>

## チェックリスト

### ドメイン層
- [ ] エンティティの不変条件が守られている
- [ ] 値オブジェクトが適切に使用されている
- [ ] ドメインサービスが必要最小限
- [ ] リポジトリインターフェースが適切

### アプリケーション層
- [ ] ユースケースが薄く保たれている
- [ ] DTOが適切に定義されている
- [ ] トランザクション境界が明確
- [ ] エラーハンドリングが一貫している

### インフラストラクチャ層
- [ ] リポジトリ実装が効率的
- [ ] マッパーが正しく動作
- [ ] 外部サービス連携が適切
- [ ] 設定管理が環境依存を吸収

### プレゼンテーション層
- [ ] APIが RESTful/適切な設計
- [ ] 入力検証が十分
- [ ] エラーレスポンスが一貫
- [ ] ドキュメントが整備されている
```

12. **Issue のレビュー更新**:
    ```bash
    gh issue comment $ARGUMENTS --body "@<作成者> レビューを完了しました。詳細は docs/review/issue-$ARGUMENTS-review.md をご確認ください。

    主な確認ポイント:
    - テストカバレッジ: X%
    - アーキテクチャ準拠: ✅
    - 改善提案: X件
    
    次のステップ: /apply-feedback でフィードバックを反映してください。"
    ```

13. **サマリー表示**:
    レビューサマリーを日本語で表示:
    ```
    レビュー完了！
    
    Issue: #$ARGUMENTS
    
    結果サマリー:
    - アーキテクチャ準拠性: ✅
    - テストカバレッジ: X%
    - 品質基準達成: X/Y項目
    
    改善提案:
    - 必須: X件
    - 推奨: Y件
    
    詳細: docs/review/issue-$ARGUMENTS-review.md
    
    次のコマンド:
    - /apply-feedback $ARGUMENTS - レビューフィードバックを反映
    ```

重要な注意点:
- TDD/DDD/レイヤードアーキテクチャの原則に焦点を当てる
- コード品質とアーキテクチャ準拠性の両方をチェック
- 優先度付きの実行可能なフィードバックを提供
- Given-When-Thenシナリオが完全に実装されていることを確認
- すべての出力とドキュメントは日本語で記述する